<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.toughguy.binheSportSystem.model.content.WXBind">

		<!-- 绑定成功添加用户信息与openid到数据库 -->
		
	<!-- <insert id="save" parameterType="WXBind"> 
		insert into cg_wx values(#{openid},#{username},#{cardno},#{usermobile},#{cashleft})
	</insert> -->
	
	
	<!-- 根据openid查询用户是否绑定过信息 -->
	
	<!-- <select id="findOne" parameterType="String" resultType="WXBind">
		select * from cg_wx where openid=#{openid} 
	</select> -->
	
	
	<!-- 根据卡号手机号查询用户信息 -->
	<select id="findBindInfo" parameterType="Map" resultType="WXBind">		
		SELECT ci.username,cm.cardno,cm.usermobile,cm.cashleft 
		FROM cg_user_moneycard cm ,cg_user_info ci  
		WHERE cm.cardno=#{cardno} AND 
		cm.usermobile=#{usermobile} AND 
		ci.usermobile=#{usermobile}
	</select>


	<!-- 根据卡号时间查询用户信息 -->
	<select id="findUsedBindInfo" parameterType="Map" resultType="WXBind">
		SELECT ci.username,cm.cardno,ci.usermobile,cm.cashleft 
		FROM cg_user_moneycard cm ,cg_user_info ci 
		WHERE cm.cardno=#{cardno} AND 
		cm.gettime IS NOT NULL AND 
		cm.usermobile=ci.usermobile
	</select>
</mapper>